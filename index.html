<!DOCTYPE html>
<html lang="es" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoMine - Plataforma de Inversi贸n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#1f2937', // gray-800
                        'accent-crypto': '#34d399', // emerald-400
                    },
                }
            }
        }
    </script>
    <style>
        body::-webkit-scrollbar { width: 8px; }
        body::-webkit-scrollbar-track { background: #111827; }
        body::-webkit-scrollbar-thumb { background: #34d399; border-radius: 4px; }
        body::-webkit-scrollbar-thumb:hover { background: #10b981; }
        /* Animaci贸n para cargar precios */
        @keyframes pulse-crypto {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .animate-crypto-pulse {
            animation: pulse-crypto 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>

<body class="bg-gray-900 text-gray-100 min-h-screen font-sans">

    <nav class="bg-primary-dark shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <span class="text-2xl font-bold text-accent-crypto">CryptoMine</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <select id="lang-selector" class="bg-gray-700 text-gray-100 rounded-md py-1 px-2 focus:ring-accent-crypto focus:border-accent-crypto">
                        </select>
                    <button id="logout-btn" class="text-sm font-medium text-red-400 hover:text-red-500 transition duration-150 ease-in-out hidden">
                        </button>
                </div>
            </div>
        </div>
    </nav>

    <main id="app-container" class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
        <h1 class="text-center text-3xl font-extrabold text-accent-crypto animate-pulse-crypto">Cargando...</h1>
    </main>

    <footer class="bg-primary-dark mt-12 border-t border-gray-700">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-sm text-gray-400">
            &copy; 2025 CryptoMine. Todos los derechos reservados.
            <div class="mt-2 space-x-4">
                <a href="#" class="hover:text-accent-crypto transition duration-150" id="footer-terms">T茅rminos de Servicio</a>
                <span class="text-gray-600">|</span>
                <a href="#" class="hover:text-accent-crypto transition duration-150" id="footer-privacy">Pol铆tica de Privacidad</a>
            </div>
        </div>
    </footer>

    <script>
        // === CONFIGURACIN Y DATOS ===
        const ADMIN_EMAIL = 'admin@mineria.com';
        const MIN_WITHDRAWAL = 16.00;
        // Direcci贸n de billetera proporcionada por el usuario
        const DEPOSIT_WALLET_ADDRESS = '0x9Ce1fcCeE06b49c256FF9648D31963D240597dff'; 
        const API_URL = 'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,solana,cardano&vs_currencies=usd';

        // Planes de Inversi贸n Actualizados
        const CONFIG_PLANS = [
            { id: 1, name: "Miner I", cost: 10, duration: 15, dailyReturn: 1.25 },
            { id: 2, name: "Miner II", cost: 50, duration: 30, dailyReturn: 6.50 },
            { id: 3, name: "Miner III", cost: 100, duration: 30, dailyReturn: 13.50 },
            { id: 4, name: "Miner IV (PRO)", cost: 500, duration: 45, dailyReturn: 70.00 }, 
            { id: 5, name: "Miner V (VIP)", cost: 1000, duration: 60, dailyReturn: 150.00 } 
        ];

        // Base de datos simulada (para registro y login estricto)
        let simulatedUsers = [];

        // Estado de sesi贸n (sin saldo inicial)
        let userState = {
            isLoggedIn: false,
            role: 'client',
            email: null,
            balance: 0.00, // Saldo inicial en cero
            activeContracts: [],
            transactionHistory: []
        };
        
        // Objeto para almacenar los precios de la API
        let realTimePrices = {};

        // === TRADUCCIONES (i18n) ===
        const translations = {
            es: {
                appName: "CryptoMine", loginTitle: "Iniciar Sesi贸n", registerTitle: "Registrarse",
                email: "Correo Electr贸nico", password: "Contrase帽a", name: "Nombre", lastName: "Apellido",
                sex: "Sexo", age: "Edad", clientPanel: "Panel de Cliente", adminPanel: "Panel de Administrador",
                myBalance: "Mi Saldo", realTimePrices: "Precios en Tiempo Real", investment: "Inversi贸n",
                deposit: "Dep贸sito", withdrawal: "Retiro", history: "Historial", logout: "Cerrar Sesi贸n",
                dailyReturn: "Ganancia Diaria", duration: "Duraci贸n", invest: "INVERTIR",
                depositTitle: "Realizar Dep贸sito", withdrawTitle: "Solicitar Retiro",
                depositWallet: "Billetera de Dep贸sito (USDT / BNB-BEP20)", depositAmount: "Monto a Depositar",
                confirmDeposit: "CONFIRMAR DEPSITO", withdrawAmount: "Monto a Retirar", withdrawWallet: "Billetera de Retiro",
                requestWithdrawal: "SOLICITAR RETIRO", contractActive: "Contratos Activos", noContracts: "No hay contratos activos. 隆Invierte ahora!",
                minWithdrawal: "Retiro M铆nimo", insufficientBalance: "Saldo insuficiente. Necesitas",
                terms: "T茅rminos de Servicio", privacy: "Pol铆tica de Privacidad",
                claimBonus: "RECLAMAR BONO DIARIO +$1.00", depositSent: "Dep贸sito de ${amount} enviado para aprobaci贸n. Esperando confirmaci贸n del administrador.",
                withdrawalSent: "Solicitud de retiro de ${amount} enviada para aprobaci贸n.",
                adminDashboard: "Panel de Administrador", metrics: "M茅tricas", support: "Bandeja de Soporte y Dep贸sitos",
                // Nuevo para registro
                signIn: "INICIAR SESIN", signUp: "REGISTRARSE", noAccount: "驴No tienes cuenta?", hasAccount: "驴Ya tienes una cuenta?",
                bonusClaimed: "隆Bono diario reclamado! Se han a帽adido $1.00 a tu saldo.",
                alreadyClaimed: "Ya reclamaste tu bono diario por hoy. 隆Vuelve ma帽ana!",
                loginSuccess: "Inicio de Sesi贸n exitoso.",
                loginFail: "Credenciales incorrectas o usuario no registrado.",
                logoutSuccess: "Cerraste sesi贸n con 茅xito.",
            },
            en: {
                appName: "CryptoMine", loginTitle: "Sign In", registerTitle: "Register",
                email: "Email", password: "Password", name: "Name", lastName: "Last Name",
                sex: "Gender", age: "Age", clientPanel: "Client Dashboard", adminPanel: "Admin Dashboard",
                myBalance: "My Balance", realTimePrices: "Real-Time Prices", investment: "Investment",
                deposit: "Deposit", withdrawal: "Withdrawal", history: "History", logout: "Log Out",
                dailyReturn: "Daily Return", duration: "Duration", invest: "INVEST",
                depositTitle: "Make Deposit", withdrawTitle: "Request Withdrawal",
                depositWallet: "Deposit Wallet (USDT / BNB-BEP20)", depositAmount: "Deposit Amount",
                confirmDeposit: "CONFIRM DEPOSIT", withdrawAmount: "Withdrawal Amount", withdrawWallet: "Withdrawal Wallet",
                requestWithdrawal: "REQUEST WITHDRAWAL", contractActive: "Active Contracts", noContracts: "No active contracts. Invest now!",
                minWithdrawal: "Minimum Withdrawal", insufficientBalance: "Insufficient balance. You need",
                terms: "Terms of Service", privacy: "Privacy Policy",
                claimBonus: "CLAIM DAILY BONUS +$1.00", depositSent: "Deposit of ${amount} sent for approval. Awaiting admin confirmation.",
                withdrawalSent: "Withdrawal request of ${amount} sent for approval.",
                adminDashboard: "Admin Dashboard", metrics: "Metrics", support: "Support and Deposit Inbox",
                // New for registration
                signIn: "SIGN IN", signUp: "REGISTER", noAccount: "Don't have an account?", hasAccount: "Already have an account?",
                bonusClaimed: "Daily bonus claimed! $1.00 has been added to your balance.",
                alreadyClaimed: "You already claimed your daily bonus today. Come back tomorrow!",
                loginSuccess: "Login successful.",
                loginFail: "Incorrect credentials or unregistered user.",
                logoutSuccess: "You logged out successfully.",
            },
            // Se asume que el resto de los 10 idiomas se a帽aden aqu铆
        };

        let currentLang = 'es';
        const langSelector = document.getElementById('lang-selector');

        // Funci贸n para obtener texto traducido
        function t(key) {
            return translations[currentLang][key] || key;
        }

        // === FUNCIONES UTILITARIAS ===
        const appContainer = document.getElementById('app-container');
        const logoutBtn = document.getElementById('logout-btn');

        function showNotification(message, type = 'success') {
            const color = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            alert(`[${type.toUpperCase()}] ${message}`);
        }

        // === OBTENER PRECIOS REALES ===
        async function fetchRealTimePrices() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error('API request failed');
                const data = await response.json();
                
                realTimePrices = {
                    BTC: data.bitcoin.usd,
                    ETH: data.ethereum.usd,
                    BNB: data.binancecoin.usd,
                    SOL: data.solana.usd,
                    ADA: data.cardano.usd
                };
                
                // Actualizar dashboard si est谩 activo
                if (userState.isLoggedIn && userState.role === 'client') {
                    renderClientDashboard();
                }
            } catch (error) {
                console.error("Error fetching crypto prices:", error);
                // Precios de respaldo en caso de fallo de la API
                realTimePrices = { BTC: 65000, ETH: 3500, BNB: 600, SOL: 150, ADA: 0.5 };
            }
        }

        // === RENDERIZADO Y FLUJO DE AUTH ===

        function renderAuth(isRegister = false) {
            logoutBtn.classList.add('hidden');
            const formTitle = isRegister ? t('registerTitle') : t('loginTitle');
            const switchLinkText = isRegister ? t('hasAccount') : t('noAccount');
            const switchTarget = isRegister ? 'login' : 'register';

            const registerFields = isRegister ? `
                <div><label for="reg-name" class="block text-sm font-medium text-gray-300">${t('name')}</label>
                    <input type="text" id="reg-name" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white"></div>
                <div><label for="reg-last-name" class="block text-sm font-medium text-gray-300">${t('lastName')}</label>
                    <input type="text" id="reg-last-name" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white"></div>
                <div><label for="reg-sex" class="block text-sm font-medium text-gray-300">${t('sex')}</label>
                    <select id="reg-sex" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white"><option value="">Seleccionar</option><option value="M">Masculino</option><option value="F">Femenino</option></select></div>
                <div><label for="reg-age" class="block text-sm font-medium text-gray-300">${t('age')}</label>
                    <input type="number" id="reg-age" min="18" max="100" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white"></div>
            ` : '';
            
            appContainer.innerHTML = `
                <div class="max-w-md mx-auto bg-primary-dark p-8 rounded-xl shadow-2xl border border-gray-700">
                    <h2 class="text-3xl font-extrabold text-center text-accent-crypto mb-6">${formTitle}</h2>
                    
                    <form id="${isRegister ? 'register-form' : 'login-form'}" class="space-y-4">
                        ${registerFields}
                        <div><label for="${isRegister ? 'reg-email' : 'login-email'}" class="block text-sm font-medium text-gray-300">${t('email')}</label>
                            <input type="email" id="${isRegister ? 'reg-email' : 'login-email'}" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-accent-crypto focus:border-accent-crypto"></div>
                        <div><label for="${isRegister ? 'reg-password' : 'login-password'}" class="block text-sm font-medium text-gray-300">${t('password')}</label>
                            <input type="password" id="${isRegister ? 'reg-password' : 'login-password'}" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-accent-crypto focus:border-accent-crypto"></div>
                        
                        <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-gray-900 bg-accent-crypto hover:bg-emerald-500 focus:outline-none transition duration-150">
                            ${isRegister ? t('signUp') : t('signIn')}
                        </button>
                    </form>
                    <p class="mt-4 text-center text-sm text-gray-400">
                        <a href="#" id="switch-auth-mode" data-mode="${switchTarget}" class="font-medium text-accent-crypto hover:text-emerald-500">${switchLinkText}</a>
                    </p>
                </div>
            `;
            // Listener para alternar entre Login y Registro
            document.getElementById('switch-auth-mode').addEventListener('click', (e) => {
                e.preventDefault();
                // Corregido: Llamar a renderAuth con el estado opuesto de registro
                renderAuth(e.target.dataset.mode === 'register');
            });
            // Listener para el formulario
            if (isRegister) {
                document.getElementById('register-form').addEventListener('submit', handleRegister);
            } else {
                document.getElementById('login-form').addEventListener('submit', handleLogin);
            }
        }
        
        function handleRegister(e) {
            e.preventDefault();
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const name = document.getElementById('reg-name').value;

            if (simulatedUsers.some(user => user.email === email)) {
                return showNotification('Este correo ya est谩 registrado.', 'error');
            }

            simulatedUsers.push({ 
                email, 
                password, 
                name,
                balance: 0.00,
                activeContracts: [],
                transactionHistory: []
            });
            showNotification('Registro exitoso. 隆Inicia sesi贸n!', 'success');
            renderAuth(false); // Volver al login
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // 1. Intento de Login Admin
            if (email === ADMIN_EMAIL) {
                userState = { ...userState, isLoggedIn: true, role: 'admin', email: ADMIN_EMAIL, balance: 99999.00 };
                renderAdminDashboard();
                return showNotification(t('loginSuccess'), 'success');
            }

            // 2. Intento de Login Cliente Registrado
            const user = simulatedUsers.find(u => u.email === email && u.password === password);

            if (user) {
                userState = { ...userState, isLoggedIn: true, role: 'client', email: user.email, 
                    balance: user.balance, activeContracts: user.activeContracts, 
                    transactionHistory: user.transactionHistory 
                };
                renderClientDashboard();
                return showNotification(t('loginSuccess'), 'success');
            } else {
                return showNotification(t('loginFail'), 'error');
            }
        }
        
        function renderClientDashboard() {
            logoutBtn.classList.remove('hidden');
            const currentBalance = userState.balance.toFixed(2);
            
            const pricesHTML = Object.keys(realTimePrices).map(key => `
                <div class="bg-gray-800 p-4 rounded-lg text-center border border-gray-700">
                    <p class="text-lg font-bold">${key}</p>
                    <p class="text-xl text-green-400">$${realTimePrices[key].toLocaleString('en-US', { minimumFractionDigits: key === 'BTC' ? 0 : 2 })}</p>
                </div>
            `).join('');

            appContainer.innerHTML = `
                <h1 class="text-4xl font-bold mb-8 text-white">${t('clientPanel')} </h1>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    
                    <div class="lg:col-span-1 bg-primary-dark p-6 rounded-xl shadow-2xl border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-accent-crypto">${t('myBalance')}</h2>
                        <p class="text-5xl font-extrabold mb-4 text-white">$${currentBalance} USD</p>
                        
                        <button id="daily-bonus-btn" class="w-full mt-4 py-2 px-4 rounded-md text-sm font-bold text-gray-900 bg-yellow-400 hover:bg-yellow-500 transition duration-150 shadow-lg hover:shadow-xl">
                            ${t('claimBonus')}
                        </button>
                    </div>

                    <div class="lg:col-span-2 bg-primary-dark p-6 rounded-xl shadow-2xl border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-accent-crypto">${t('realTimePrices')}</h2>
                        <div class="grid grid-cols-5 gap-4">
                            ${pricesHTML}
                        </div>
                    </div>
                </div>

                <div class="mt-8">
                    <div class="border-b border-gray-700">
                        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                            <button id="tab-inversion" class="tab-button border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-200 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition duration-150" data-target="investment">${t('investment')}</button>
                            <button id="tab-deposit" class="tab-button border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-200 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition duration-150" data-target="deposit">${t('deposit')}</button>
                            <button id="tab-withdraw" class="tab-button border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-200 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition duration-150" data-target="withdraw">${t('withdrawal')}</button>
                            <button id="tab-history" class="tab-button border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-200 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition duration-150" data-target="history">${t('history')}</button>
                        </nav>
                    </div>

                    <div id="tab-content" class="mt-6 bg-primary-dark p-6 rounded-xl shadow-2xl border border-gray-700">
                        </div>
                </div>
            `;
            
            // Inicializar la vista de Inversi贸n y listeners
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', (e) => switchTab(e.target.dataset.target));
            });
            switchTab('investment'); 
            document.getElementById('daily-bonus-btn').addEventListener('click', handleDailyBonus);
        }

        function handleDailyBonus() {
            // L贸gica para marcar en el usuario simulado que ya reclam贸
            const userIndex = simulatedUsers.findIndex(u => u.email === userState.email);
            if (userIndex === -1) return;

            // Simple check based on current date (needs persistence logic in a real app)
            if (userState.transactionHistory.some(t => t.type === 'bonus' && new Date(t.date).toDateString() === new Date().toDateString())) {
                return showNotification(t('alreadyClaimed'), 'error');
            }

            const bonusAmount = 1.00;
            userState.balance += bonusAmount;
            userState.transactionHistory.push({ type: 'bonus', description: t('bonusClaimed').replace('$1.00', `+${bonusAmount.toFixed(2)}`), date: Date.now() });

            // Sincronizar con el "usuario simulado"
            simulatedUsers[userIndex].balance = userState.balance;
            simulatedUsers[userIndex].transactionHistory = userState.transactionHistory;
            
            showNotification(t('bonusClaimed'), 'success');
            renderClientDashboard(); 
        }

        function handleInvestment(planId) {
            const plan = CONFIG_PLANS.find(p => p.id === planId);
            if (!plan) return showNotification('Plan no encontrado.', 'error');

            if (userState.balance >= plan.cost) {
                userState.balance -= plan.cost;
                userState.activeContracts.push({ name: plan.name, dailyReturn: plan.dailyReturn, duration: plan.duration, startDate: Date.now() });
                userState.transactionHistory.push({ type: 'investment', description: `Inversi贸n en ${plan.name} -$${plan.cost.toFixed(2)}`, date: Date.now() });
                
                // Sincronizar con el usuario simulado
                const userIndex = simulatedUsers.findIndex(u => u.email === userState.email);
                if (userIndex !== -1) {
                    simulatedUsers[userIndex].balance = userState.balance;
                    simulatedUsers[userIndex].activeContracts = userState.activeContracts;
                    simulatedUsers[userIndex].transactionHistory = userState.transactionHistory;
                }
                
                showNotification(`隆Inversi贸n exitosa! Contrato ${plan.name} activado.`, 'success');
                renderClientDashboard();
            } else {
                showNotification(`${t('insufficientBalance')} $${(plan.cost - userState.balance).toFixed(2)} m谩s.`, 'error');
            }
        }
        
        function switchTab(tab) {
            // ... (L贸gica de cambio de pesta帽a igual)
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('border-accent-crypto', 'text-white');
                btn.classList.add('border-transparent', 'text-gray-400');
            });
            const activeTabButton = document.querySelector(`[data-target="${tab}"]`);
            if (activeTabButton) {
                activeTabButton.classList.add('border-accent-crypto', 'text-white');
                activeTabButton.classList.remove('border-transparent', 'text-gray-400');
            }

            const tabContent = document.getElementById('tab-content');
            
            if (tab === 'investment') {
                tabContent.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4 text-white">${t('investment')}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        ${CONFIG_PLANS.map(p => `
                            <div class="p-6 bg-gray-800 rounded-lg shadow-xl border-t-4 border-accent-crypto flex flex-col justify-between h-full">
                                <div>
                                    <h4 class="text-xl font-bold mb-2 text-accent-crypto">${p.name}</h4>
                                    <p class="text-4xl font-extrabold mb-4 text-white">$${p.cost} USD</p>
                                    <p class="text-gray-400 mb-2">${t('dailyReturn')}: <span class="font-bold text-yellow-400">$${p.dailyReturn.toFixed(2)}</span></p>
                                    <p class="text-gray-400">${t('duration')}: ${p.duration} d铆as</p>
                                </div>
                                <button onclick="handleInvestment(${p.id})" class="mt-4 w-full py-2 bg-emerald-600 text-white font-bold rounded-md hover:bg-emerald-700 transition duration-150">
                                    ${t('invest')}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                    <h3 class="text-xl font-semibold mt-8 mb-4 text-white">${t('contractActive')}</h3>
                    <ul class="space-y-2">
                        ${userState.activeContracts.length > 0 ?
                            userState.activeContracts.map(c => `<li class="p-3 bg-gray-800 rounded-lg shadow-inner flex justify-between items-center"><span>${c.name}</span><span class="text-yellow-400 font-bold">$${c.dailyReturn.toFixed(2)}/${t('duration').toLowerCase().split(' ')[0]}</span></li>`).join('') :
                            `<p class="text-gray-400">${t('noContracts')}</p>`
                        }
                    </ul>
                `;
            } else if (tab === 'deposit') {
                tabContent.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4 text-white">${t('depositTitle')}</h3>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <p class="mb-4 text-gray-300">Env铆a el monto a la siguiente billetera y confirma. El administrador lo verificar谩 y acreditar谩 en tu saldo.</p>
                        <label class="block text-sm font-medium text-gray-300 mb-1">${t('depositWallet')}</label>
                        <div class="p-4 bg-gray-700 rounded-md mb-4 font-mono text-sm break-all select-all">
                            <span class="text-accent-crypto">${DEPOSIT_WALLET_ADDRESS}</span>
                        </div>
                        <form id="deposit-form" class="space-y-4">
                            <div>
                                <label for="deposit-amount" class="block text-sm font-medium text-gray-300">${t('depositAmount')}</label>
                                <input type="number" id="deposit-amount" min="1" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white">
                            </div>
                            <button type="submit" class="w-full py-2 bg-blue-600 text-white font-bold rounded-md hover:bg-blue-700 transition duration-150">
                                ${t('confirmDeposit')}
                            </button>
                        </form>
                    </div>
                `;
                document.getElementById('deposit-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const amount = parseFloat(document.getElementById('deposit-amount').value);
                    if (amount > 0) {
                        showNotification(t('depositSent').replace('${amount}', `$${amount.toFixed(2)}`), 'success');
                    }
                });
            } else if (tab === 'withdraw') {
                tabContent.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4 text-white">${t('withdrawTitle')}</h3>
                    <p class="text-yellow-400 mb-4">${t('minWithdrawal')}: $${MIN_WITHDRAWAL.toFixed(2)}</p>
                    <form id="withdraw-form" class="space-y-4 bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div>
                            <label for="withdraw-amount" class="block text-sm font-medium text-gray-300">${t('withdrawAmount')} (Max: $${userState.balance.toFixed(2)})</label>
                            <input type="number" id="withdraw-amount" min="${MIN_WITHDRAWAL}" max="${userState.balance.toFixed(2)}" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white">
                        </div>
                        <div>
                            <label for="withdraw-wallet" class="block text-sm font-medium text-gray-300">${t('withdrawWallet')} (USDT / BEP20)</label>
                            <input type="text" id="withdraw-wallet" required class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white">
                        </div>
                        <button type="submit" class="w-full py-2 bg-red-600 text-white font-bold rounded-md hover:bg-red-700 transition duration-150">
                            ${t('requestWithdrawal')}
                        </button>
                    </form>
                `;
                document.getElementById('withdraw-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const amount = parseFloat(document.getElementById('withdraw-amount').value);
                    if (amount >= MIN_WITHDRAWAL && amount <= userState.balance) {
                        showNotification(t('withdrawalSent').replace('${amount}', `$${amount.toFixed(2)}`), 'success');
                    } else if (amount < MIN_WITHDRAWAL) {
                         showNotification(`${t('minWithdrawal')} es $${MIN_WITHDRAWAL.toFixed(2)}.`, 'error');
                    } else {
                         showNotification(`${t('insufficientBalance')}`, 'error');
                    }
                });
            } else if (tab === 'history') {
                 const historyHTML = userState.transactionHistory.length > 0 ?
                    userState.transactionHistory.map(t => `
                        <li class="p-3 border-b border-gray-700 flex justify-between items-center text-sm hover:bg-gray-700 transition duration-150">
                            <span class="${t.type === 'deposit' || t.type === 'bonus' ? 'text-green-400' : 'text-red-400'} font-medium">${t.description}</span>
                            <span class="text-gray-400 font-mono">${new Date(t.date).toLocaleString()}</span>
                        </li>
                    `).join('') :
                    '<p class="text-center py-4 text-gray-400">No hay transacciones recientes.</p>';

                tabContent.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4 text-white">${t('history')}</h3>
                    <ul class="space-y-1">
                        ${historyHTML}
                    </ul>
                `;
            }
        }
        
        function renderAdminDashboard() {
            logoutBtn.classList.remove('hidden');
            const firstUserEmail = simulatedUsers[0]?.email || 'usuario@ejemplo.com';
             appContainer.innerHTML = `
                <h1 class="text-4xl font-bold mb-8 text-white">${t('adminDashboard')} </h1>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-primary-dark p-6 rounded-xl shadow-2xl border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-accent-crypto">${t('metrics')}</h2>
                        <p class="text-2xl font-bold">Total Usuarios: <span class="text-green-400">${simulatedUsers.length}</span></p>
                        <p class="text-md text-gray-400 mt-2">Dep贸sitos Pendientes: <span class="text-yellow-400">3 (Sim)</span></p>
                    </div>
                    <div class="lg:col-span-2 bg-primary-dark p-6 rounded-xl shadow-2xl border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-accent-crypto">${t('support')}</h2>
                        <ul class="space-y-3 h-64 overflow-y-auto bg-gray-800 p-4 rounded-lg">
                            <li class="bg-gray-700 p-3 rounded-md text-sm">
                                <span class="font-bold text-yellow-400">[DEPSITO PENDIENTE]</span> User: ${firstUserEmail} solicita $50 USD. 
                                <button onclick="simulateDepositConfirmation(50, '${firstUserEmail}')" class="ml-4 text-green-400 hover:text-green-500 font-bold">Confirmar y Sumar Saldo</button>
                            </li>
                            <li class="bg-gray-700 p-3 rounded-md text-sm">
                                <span class="font-bold text-blue-400">[SOPORTE CHAT]</span> Usuario Y: "No veo mis ganancias diarias."
                            </li>
                        </ul>
                    </div>
                </div>
             `;
        }
        
        // Funci贸n de simulaci贸n para admin
        function simulateDepositConfirmation(amount, userEmail) {
            const userIndex = simulatedUsers.findIndex(u => u.email === userEmail);
            if (userIndex !== -1) {
                simulatedUsers[userIndex].balance += amount;
                simulatedUsers[userIndex].transactionHistory.push({ type: 'deposit', description: `Dep贸sito Acreditado +$${amount.toFixed(2)}`, date: Date.now() });
                // Si el usuario actualmente logeado es el mismo, actualiza su estado
                if (userState.email === userEmail) {
                    userState.balance = simulatedUsers[userIndex].balance;
                    userState.transactionHistory = simulatedUsers[userIndex].transactionHistory;
                }

                showNotification(`Se han acreditado $${amount.toFixed(2)} a ${userEmail}.`, 'success');
                renderAdminDashboard(); 
            } else {
                showNotification(`Usuario ${userEmail} no encontrado en la base de datos.`, 'error');
            }
        }


        // === INICIALIZACIN Y TRADUCCIN ===

        function updateUIforLanguage() {
            // Actualizar textos fijos
            document.getElementById('logout-btn').textContent = t('logout');
            document.getElementById('footer-terms').textContent = t('terms');
            document.getElementById('footer-privacy').textContent = t('privacy');
            
            // Renderizar la vista actual (Auth, Client o Admin) para actualizar todos los textos din谩micos
            if (userState.isLoggedIn) {
                userState.role === 'admin' ? renderAdminDashboard() : renderClientDashboard();
            } else {
                // Preservar la vista de registro/login si el usuario estaba en ella
                const isRegisterView = document.getElementById('register-form');
                renderAuth(!!isRegisterView);
            }
        }
        
        function initApp() {
            // 1. Inicializar Selector de Idioma
            const langKeys = Object.keys(translations);
            langKeys.forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = key.toUpperCase();
                langSelector.appendChild(option);
            });
            const browserLang = navigator.language.split('-')[0];
            if (langKeys.includes(browserLang)) {
                 currentLang = browserLang;
            }
            langSelector.value = currentLang;
            langSelector.addEventListener('change', (e) => {
                currentLang = e.target.value;
                updateUIforLanguage();
            });
            
            // 2. Cargar Precios y Renderizar UI
            fetchRealTimePrices().then(() => {
                // Simular un usuario para pruebas si no hay registrados
                if (simulatedUsers.length === 0) {
                     simulatedUsers.push({ email: 'test@user.com', password: 'password', name: 'Test', balance: 15.00, activeContracts: [], transactionHistory: [{ type: 'deposit', description: 'Dep贸sito Inicial (Demo) +$15.00', date: Date.now() }] });
                }
                updateUIforLanguage(); // Primer renderizado
            });
            
            // 3. Listener de Cerrar Sesi贸n
            logoutBtn.addEventListener('click', () => {
                userState = { isLoggedIn: false, role: 'client', email: null, balance: 0.00, activeContracts: [], transactionHistory: [] };
                showNotification(t('logoutSuccess'), 'info');
                renderAuth();
            });
        }

        initApp();
    </script>
</body>
</html>